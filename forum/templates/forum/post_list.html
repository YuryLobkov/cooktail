{% extends 'forum/base.html' %}
{% block title %}Posts{% endblock title %}
{% block content %}
<h1>FORUM</h1>
<a href="/forum">Back to home</a>
<a href="/forum/create-post">Create post</a>
<br></br>
{% for post in posts %}
<ul>
    <li>
        <table>
            <tr>
                <th th style="border: 1px black solid;">Post:</th>
            </tr>
            <tr>
                <th style="border: 1px black solid;">Author</th>
                <th style="border: 1px black solid;">Title</th>
                <th style="border: 1px black solid;">Content</th>
                <th style="border: 1px black solid;">Created at</th>
                <th style="border: 1px black solid;">Updated at</th>
            </tr>
            <tr>
                <td style="border: 1px black solid;">{{post.author.username}}</td>
                <td style="border: 1px black solid;">{{post.title}}</td>
                <td style="border: 1px black solid;">{{post.content}}</td>
                <td style="border: 1px black solid;">{{post.created_at}}</td>
                <td style="border: 1px black solid;">{{post.updated_at}}</td>
            </tr>
        </table>
    </li>
        <table>
            <tr>
                {% if user == post.author %}
                    <th>
                        <form method="POST">
                            {% csrf_token %}
                            <button type="submit" name="post-id" value="{{post.id}}">‚ùå</button>
                        </form>
                    </th>
                    <th>
                        <form action="{% url 'forum:update-post' post.pk %}">
                            <button type="submit">‚úè</button>
                        </form>
                    </th>                      
                {% endif %}
                    <th>
                        <form action="{% url 'forum:create-comment' post.pk %}">
                            <button type="submit">üí¨</button>
                        </form>
                    </th>
            </tr>
        </table>
    <li>
        <table>
            <tr>
                <th style="border: 1px black solid;">Comments:</th>
            </tr>
            <tr>
                <th style="border: 1px black solid;">Name</th>
                <th style="border: 1px black solid;">Content</th>
                <th style="border: 1px black solid;">Date</th>
            </tr>
            {% for comment in post.comments.all %}
            <tr>
                    <td style="border: 1px black solid;">{{comment.name}}</td>
                    <td style="border: 1px black solid;">{{comment.body}}</td>
                    <td style="border: 1px black solid;">{{comment.post_date}}</td>
            </tr>
            {% endfor %}
        </table>
    </li>
</ul>
{% empty %}
<p>No posts yet :(</p>
{% endfor %}
{% endblock content %}